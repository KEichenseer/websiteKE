"0","change_point <- as.numeric(names(sort(table(CPRs$n_change),decreasing = T)))[1] # mode as the change point"
"0","phase_1 <- 1:(change_point-1)"
"0","phase_2 <- change_point:n"
"0","phase_col <- rep(rgb(0,0.3,1,0.75), n)"
"0","phase_col[phase_2] <- rgb(0.9,0.4,0,0.75)"
"0",""
"0","par(mar = c(3.6,3.6,0.3,0.3), las = 1, mgp = c(2.25,0.75,0), cex = 1.35)"
"0",""
"0","reg1_seq <- seq(min(x[phase_1]),max(x[phase_1]),length.out = 100)"
"0","reg2_seq <- seq(min(x[phase_2]),max(x[phase_2]),length.out = 100)"
"0",""
"0","reg1 <- CPRm$alpha_1 + CPRm$beta_1*reg1_seq"
"0","reg2 <- (CPRm$alpha_1+CPRm$alpha_2) + (CPRm$beta_1+ CPRm$beta_2)*reg2_seq"
"0",""
"0","### Calculate confidence intervals"
"0","reg1_025 <- sapply(1:100, function(x) quantile(CPRs$alpha_1 + CPRs$beta_1*reg1_seq[x], probs = 0.025))"
"0","reg1_975 <- sapply(1:100, function(x) quantile(CPRs$alpha_1 + CPRs$beta_1*reg1_seq[x], probs = 0.975))"
"0","reg2_025 <- sapply(1:100, function(x) quantile(CPRs$alpha_1 + CPRs$alpha_2 + (CPRs$beta_1+CPRs$beta_2)*reg2_seq[x], probs = 0.025))"
"0","reg2_975 <- sapply(1:100, function(x) quantile(CPRs$alpha_1 + CPRs$alpha_2 + (CPRs$beta_1+CPRs$beta_2)*reg2_seq[x], probs = 0.975))"
"0",""
"0","plot(x,y, type = ""n"")"
